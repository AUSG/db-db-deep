# 8장

Edited by Seungho Song

# 8장 : 테이블 설계의 기초

## 테이블의 속성

1. 어떤 공통의 속성을 가진 것들의 집합이다.
2. 현실 세계를 반영한 상(Image, Abstraction)이다.

## 테이블 설계 시 안티패턴(Anti-Pattern)

> 올바르지 못한 패턴들
> 
1. 사물과 집합의 계층성을 무시한 사례
    
    계층성을 무시하고 모든 데이터들을 한 테이블 안에 쏟아부으면 안된다.
    
    | 이름 | 색 | 맛 |
    | --- | --- | --- |
    | 완두콩 | 초록 | 약간 쓰다 |
    
    | 이름 | 색 | 맛 |
    | --- | --- | --- |
    | 토마토 | 빨강 | 새콤 |
    
    | 이름 | 색 | 맛 |
    | --- | --- | --- |
    | 옥수수 | 노랑 | 약간 달다 |
    
    물론, 데이터들의 타입이 각자 다른 토마토, 각자 다른 옥수수들이라면 그것들의 상위 집합으로서 ‘토마토’, ‘옥수수’는 가능할지라도, 현재 가진 데이터들의 타입을 ‘토마토’로 묶어주지 못한다면 테이블로서 부적절하다.
    
    > 채소 → 토마토, 완두콩, 옥수수 → 방울토마토, 초록토마토, ….. (계층에 따른 집합을 지켜줘야 한다.)
    > 
    
    따라서, **가장 상위의 개념집합**으로 정리하면 테이블 설계가 명확해진다.
    
2. 현실세계엔 같은 인스턴스가 2개 존재할 수 없다. 데이터베이스에서도 동일하다.
    
    하나의 행이 가리키는 데이터는 유일성을 가져야 한다. 한 테이블 내 2개 이상의 행이 동일 인스턴스를 가리키고 있다면, 데이터 조회 시 어떤 행을 선택해야할지 모른다.
    
    → 기본키를 이용하여 각 행들에 유일성을 부여해야 한다. 당연히 기본키는 중복되면 안된다.
    
    ### 기본키가 바뀐다면?
    
    1. UPDATE 시 값의 유일성을 보증할 수 없다.
    2. 과거 데이터와의 결합이 어렵다.
    
    예) ‘송승호’라는 이름을 가진 행의 데이터를 UPDATE → ‘승호송’ 으로 바꿀 때, 기존 데이터 중 ‘승호송’ 이름을 가진 데이터가 존재한다면 Conflict. (전제조건 : 기본키가 이름)
    
3. 기본키 열로 NULL은 불가하다.

## 테이블의 함수적 특징

- 기본키의 핵심적인 특징
    - 레코드의 단일성을 보증해야 한다.
        
        = 기본키를 특정 (input) 하면 어떤 레코드의 열 값 전체가 고유하게 특정 (output) 된다.
        
        = 기본키 → 열 값 전체가 뽑혀야 한다. 이것이 테이블의 함수적 특성이다.
        
- 함수의 종속이란?
    - 특정 input 값으로 부터 나오는 output이 자명할 때, 즉 단일 output만 가질 때 종속적이라 한다.

## 정규형

> 테이블 설계 시 이론적으로 따라야 하는 표준(?) 형식
> 

### 정규형의 목적

: 데이터의 갱신 발생 시 부정합을 방지하기 위함.

### 제1정규형 (1NF)

> 테이블 셀에 복합적인 값을 포함하지 않는다.
> 

→ 하나의 셀엔 하나의 데이터만 가져야 한다.

| 이름 | 색 | 맛 |
| --- | --- | --- |
| 옥수수 | 노랑, 초록 | 약간 달다 |

위 표와 같이 하나의 셀에 두개 이상의 데이터가 들어갈 경우, 추후 옥수수 데이터의 색을 조회 시 어떤 값을 가져와야 할지 모르기 때문. 추후 기본키를 통해 해당 행을 조회 시 ‘단일성’을 보증할 수 없으므로 X

### 제2정규형 (2NF)

> 제1정규형을 만족하면서 ‘부분함수 종속성’이 없어야 한다.
> 
- 부분함수 종속성
    - 기본키를 구성하는 열의 일부에만 함수 종속이 존재하는 것.
- 어떤 테이블의 기본키는 (A, B)지만, 기본키의 일부분인 A는 함수의 종속성을 가지고, B는 종속성을 가지지 않으면 테이블을 조회 시, B 기본키만으로 알 수 있는 것이 없다.
- 이 땐, 부분적으로 종속되는 데이터들을 기존 테이블에서 분리해야 한다.

→ 추후 데이터 갱신 시, 갱신 이상을 방지할 수 있다. (247~248p)

### 제3정규형 (3NF)

> 제2정규형을 만족하면서 ‘추이함수 종속성’이 없어야 한다.
> 
- 추이함수 종속성
    - 기본키 이외의 키 간에 발생하는 함수 종속.
    - 보통 테이블 속에 테이블이 하나 더 있는 것처럼 보일 때 많이 보이는 경우.
        
        
        | 이름 (PK) | 색 | 맛 | 유통회사코드 | 유통회사명 |
        | --- | --- | --- | --- | --- |
        | 옥수수 | 노랑 | 약간 달다 | 001 | 승호유통 |
    
    이땐, 유통회사코드 및 유통회사명을 추가하고 싶어도, 품종을 모르는 한 추가할 수가 없는 구조기 때문에 갱신 이상 발생.
    
    → 이 역시 추이함수 종속이 일어나는 부분을 기존 테이블로부터 분리해야 한다.
    

## ER Diagram

> Entity - Relationship Diagram
> 

### Entity

실질적으로 테이블을 지칭한다.

### Relationship

엔티티 간의 관련성을 묘사하는 선을 지칭한다. ← 외래키 (Foreign Key)를 사용하여 엔티티 간의 관계를 정의한다.
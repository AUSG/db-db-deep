# 8장: 테이블 설계의 기초

## 기본키 특성
* 기본키는 행(row)을 유일하게 식별할 수 있는 값이어야 한다.
* 기본키 값으로 NULL을 삽입할 수 없다.
* 복합키는 행(row)을 유일하게 식별할 수 있는 최소한의 속성 조합으로 구성

## 정규화
데이터의 갱신이 발생한 경우에도 부정합이 발생하기 어려운 형태의 테이블 설계 이론이다. 문제가 생길 수 있는 커다란 테이블을 문제가 없도록 작은 테이블로 나누는 것이다.

### 1. 제 1정규형 (1NF)
* 테이블 셀에 복합적인 값을 포함하지 않는다. (원자성)
* 각 행의 컬럼값은 단일값이어야 한다.
<img width="398" alt="스크린샷 2023-09-18 오후 9 29 19" src="https://github.com/twoosky/db-db-deep/assets/50009240/edda4c00-9cb7-4647-beee-19951337e61c">

### 2. 제 2정규형 (2NF)
* 테이블의 모든 컬럼이 `완전 함수적 종속`을 만족해야 한다.
* 완전 함수적 종속은 속성 값의 결정이 기본키(또는 복합키)의 전체를 참조하는 것이다.
* 기본키가 {이름, 담당수업}인 테이블에서 2NF를 충족하려면, 속성{국적}의 결정은 기본키 전체{이름, 담당수업}를 참조해야 한다.
* 하지만, 기본키에 있는 {이름}만 알아도, 속성{국적}을 알 수 있다.
* 따라서, 2NF을 충족하기 위해선 테이블을 두 개로 나눠야 한다.
  * 첫번째 테이블: 결정할 속성은 없지만, 복합키{이름, 담당수업} 전체가 테이블을 이룸 (2NF)
  * 두번째 테이블: 속성{국적}이 기본키{이름} 전체를 참조함 (2NF)
<img width="419" alt="스크린샷 2023-09-18 오후 9 29 27" src="https://github.com/twoosky/db-db-deep/assets/50009240/8b58e7b1-9f1b-42f1-bb35-f45f66ec1675">

> 제2정규형 설계를 하지 않는다면?  
> 국적을 모르는 외부강사의 담당 수업을 등록해야하는 경우 국적 속성에 NULL을 허용하든지, 더미 값을 넣어야된다.  
> 같은 이름에 대한 국적 행이 복수 행 존재하므로, 일부만 잘못 수정되거나 등록될 위험 존재  

### 3. 제 3정규형 (3NF)
* 모든 속성이 기본키(또는 복합키)에 `이행적 함수 종속`이 되지 않아야 한다.
* 이행적 함수 종속이란 X가 기본키일 때, `X->Y이고, Y->Z면 X->Z`가 되는 것을 말한다.
  * `X->Y`: 기본키{강의시간, 이름}가 속성{담당수업}을 결정한다
  * `Y->Z`: 속성{담당수업}은 또 다른 속성{수업코드}을 결정한다
  * `X->Z 성립`: 기본키{강의시간, 이름}이 속성{수업코드} 자동적으로 결정
* 3NF를 충족하기 위해선, **(X->Y), (Y->Z) 테이블을 분리**해야 한다.
<img width="488" alt="스크린샷 2023-09-18 오후 9 29 41" src="https://github.com/twoosky/db-db-deep/assets/50009240/8a7821f1-79e1-474a-861c-ed92e7f3ede3">

> 이행적 함수 종속 존재 시 갱신 이상이 발생할 수 있다.  
> 2NF 테이블의 경우 강의하지 않는 수업에 대한 수업코드는 등록할 수 없다.
